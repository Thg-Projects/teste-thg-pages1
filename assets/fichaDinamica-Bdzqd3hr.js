import"./essencial-DjFnyu8i.js";import{r as C,U as E,a as y,o as f,s as I}from"./firebaseFuncoes-B1sqI8Vj.js";import"./init-CaxVF7j6.js";import"https://www.gstatic.com/firebasejs/9.22.1/firebase-app.js";import"https://www.gstatic.com/firebasejs/9.22.1/firebase-auth.js";import"https://www.gstatic.com/firebasejs/9.22.1/firebase-database.js";function S(i,p){const c=document.getElementById(p);if(!c){console.error(`Elemento container com ID "${p}" não encontrado no HTML.`);return}c.innerHTML="";let r=null;if(i&&typeof i=="object"&&(i.treinamento&&typeof i.treinamento=="object"&&i.treinamento.sequencias&&typeof i.treinamento.sequencias=="object"?r=i.treinamento.sequencias:i.sequencias&&typeof i.sequencias=="object"&&(r=i.sequencias)),!r||typeof r!="object"){console.warn("Dados de treino do Firebase inválidos ou sem sequências válidas. Nenhuma ficha será renderizada.");const o=document.createElement("button");o.id="add-first-sequence",o.classList.add("add-button"),o.textContent="Adicionar Primeira Sequência",c.appendChild(o);const a=document.createElement("button");a.id="save-workout",a.classList.add("save-button"),a.textContent="Salvar Ficha",c.appendChild(a);return}const d=Object.keys(r);d.forEach(o=>{const a=r[o];if(!a||typeof a!="object"){console.warn(`Dados inválidos para a sequência com chave ${o}. Pulando.`);return}const v=document.createElement("div");v.classList.add("sequencia"),v.dataset.sequenceId=o;const g=document.createElement("h3");g.classList.add("sequencia-header"),g.textContent=a.nome||"Sequência Sem Nome",v.appendChild(g);const x=document.createElement("div");x.classList.add("exercicios-grupo");const l=document.createElement("div");if(l.classList.add("exercicio-header-row"),l.innerHTML=`
          <div class="header-label exercicio-nome-label">Exercício</div>
          <div class="header-label exercicio-series-label">Séries</div>
          <div class="header-label exercicio-repeticoes-label">Repetições</div>
          <div class="header-label exercicio-carga-label">Carga</div>
          <div class="header-label remove-button-label"></div> `,x.appendChild(l),a.exercicios&&typeof a.exercicios=="object")Object.keys(a.exercicios).forEach(b=>{const m=a.exercicios[b];if(!m||typeof m!="object"){console.warn(`Dados inválidos para o exercício com chave ${b} na sequência ${o}. Pulando.`);return}const q=document.createElement("div");q.classList.add("exercicio-row"),q.dataset.exerciseId=b,q.dataset.sequenceId=o,q.innerHTML=`
                 <div class="field border" style="top: 8px;">
                     <input type="text" class="exercicio-nome" value="${m.nome||""}" placeholder="Exercício"></div>
                     <div class="field border"><input type="number" class="exercicio-series" value="${m.series||""}" placeholder="Séries"></div>
                     <div class="field border"><input type="number" class="exercicio-repeticoes" value="${m.repeticoes||""}" placeholder="Repetições"></div>
                    <div class="field border"><input type="text" class="exercicio-carga" value="${m.carga||""}" placeholder="Carga"></div>
                    <button class="remove-button" style="top: -8px;">Remover</button>
              `,x.appendChild(q)});else{console.log(`Nenhum objeto de exercícios encontrado ou válido para a sequência "${a.nome}" (Chave: ${o}).`);const u=document.createElement("p");u.textContent="Nenhum exercício adicionado a esta sequência ainda.",u.style.fontStyle="italic",u.style.textAlign="center",u.style.marginTop="10px",x.appendChild(u)}v.appendChild(x);const h=document.createElement("button");h.classList.add("add-button"),h.dataset.sequenceId=o,h.textContent="Adicionar Exercício a esta Sequência",v.appendChild(h),c.appendChild(v)});const s=document.createElement("button");s.id="add-new-sequence",s.classList.add("add-button"),s.textContent="Adicionar Nova Sequência",c.appendChild(s);const e=document.createElement("button");e.className="extra large-elevate",e.setAttribute("data-ui","#treinoDiaglog"),e.style.inlineSize="auto",e.style.padding="0 1.5rem",e.style.color="#212121",e.style.backgroundColor="#4caf50",e.classList.add("save-button"),e.id="save-workout",e.className="bottom extra",e.style.position="fixed",e.style.bottom="20px",e.style.zIndex="101",e.style.right="10px",e.style.setProperty("background-color","#4caf50","important");const n=document.createElement("i");n.textContent="save";const t=document.createElement("span");t.textContent="Salvar Ficha",e.appendChild(n),e.appendChild(t),c.appendChild(e),console.log(`Renderização da ficha de treino a partir do Firebase concluída. ${d.length} sequências renderizadas.`)}document.addEventListener("DOMContentLoaded",function(){const i="training-sheet",p=document.getElementById(i),c=`/usuarios/${E}/treinamento`,r=async()=>{try{console.log("Carregando dados de treino do Firebase...");const d=await f(c);console.log("Dados carregados:",d),S(d,i)}catch(d){console.error("Erro ao carregar dados iniciais do Firebase:",d),p&&(p.innerHTML='<p style="color: red;">Erro ao carregar a ficha de treino.</p>')}};r(),p?p.addEventListener("click",async function(d){const s=d.target;if(s.classList.contains("remove-button")){const e=s.closest(".exercicio-row");if(e){const n=e.dataset.sequenceId,t=e.dataset.exerciseId;if(n&&t){console.log(`Tentando remover exercício ${t} da sequência ${n}`);const o=`${c}/sequencias/${n}/exercicios/${t}`;try{await C(o),console.log("Exercício removido do Firebase. Atualizando UI..."),r()}catch(a){console.error("Falha ao remover exercício:",a)}}else console.warn("IDs de sequência ou exercício não encontrados na linha para remover.")}}if(s.classList.contains("add-button")&&s.id!=="add-new-sequence"&&s.id!=="add-first-sequence"){const e=s.dataset.sequenceId;if(e){console.log(`Tentando adicionar novo exercício à sequência ${e}`);const n=`${c}/sequencias/${e}/exercicios`,t={nome:"",series:"0",repeticoes:"0",carga:""};try{const o=await y(n,t);console.log("Novo exercício adicionado ao Firebase. Atualizando UI..."),r()}catch(o){console.error("Falha ao adicionar novo exercício:",o)}}else console.warn("ID da sequência não encontrado no botão 'Adicionar Exercício'.")}if(s.id==="add-first-sequence"||s.id==="add-new-sequence"){console.log("Tentando adicionar nova sequência...");const e=`${c}/sequencias`,n=await f(c);let t=0;n&&n.treinamento&&n.treinamento.sequencias?t=Object.keys(n.treinamento.sequencias).length:n&&n.sequencias&&(t=Object.keys(n.sequencias).length);const o={nome:`Sequência ${t+1}`,exercicios:{}};try{const a=await y(e,o);console.log("Nova sequência adicionada ao Firebase. Atualizando UI..."),r()}catch(a){console.error("Falha ao adicionar nova sequência:",a)}}if(s.id==="save-workout"){console.log("Botão 'Salvar Ficha Completa' clicado!");const e=p.querySelectorAll(".sequencia"),n={sequencias:{}};e.forEach(t=>{const o=t.dataset.sequenceId;if(!o){console.warn("Sequência sem data-sequence-id encontrada. Pulando salvamento desta sequência.");return}const a=t.querySelector(".sequencia-header"),v=a?a.textContent.trim():"Sequência Sem Nome",g=t.querySelectorAll(".exercicio-row"),x={};g.forEach(l=>{const h=l.dataset.exerciseId;if(!h){console.warn(`Exercício sem data-exercise-id encontrado na sequência ${o}. Pulando salvamento deste exercício.`);return}const u=l.querySelector(".exercicio-nome"),b=l.querySelector(".exercicio-series"),m=l.querySelector(".exercicio-repeticoes"),q=l.querySelector(".exercicio-carga");x[h]={nome:u?u.value.trim():"",series:b?b.value.trim():"",repeticoes:m?m.value.trim():"",carga:q?q.value.trim():""}}),n.sequencias[o]={nome:v,exercicios:x}}),console.log("Dados coletados da UI para salvar:",n);try{await I(`${c}/sequencias`,n.sequencias),console.log("Ficha de treino salva no Firebase!"),alert("Ficha de treino salva com sucesso!")}catch(t){console.error("Falha ao salvar a ficha de treino:",t)}}}):console.error("Container de ficha de treino não encontrado para configurar ouvintes de evento.")});
